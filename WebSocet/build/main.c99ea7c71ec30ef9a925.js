(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{"6yvc":function(e,a,t){var n=t("mp5j");e.exports=(n.default||n).template({compiler:[8,">= 4.3.0"],main:function(e,a,t,n,s){var r,o=null!=a?a:e.nullContext||{},l=e.hooks.helperMissing,c="function",i=e.escapeExpression;return'<li class="message '+i(typeof(r=null!=(r=t.className||(null!=a?a.className:a))?r:l)===c?r.call(o,{name:"className",hash:{},data:s,loc:{start:{line:1,column:19},end:{line:1,column:32}}}):r)+'">\r\n    <img class="image" src="'+i(typeof(r=null!=(r=t.image||(null!=a?a.image:a))?r:l)===c?r.call(o,{name:"image",hash:{},data:s,loc:{start:{line:2,column:28},end:{line:2,column:37}}}):r)+'">\r\n    <div class="message-body">\r\n        <span class="user-name">'+i(typeof(r=null!=(r=t.name||(null!=a?a.name:a))?r:l)===c?r.call(o,{name:"name",hash:{},data:s,loc:{start:{line:4,column:32},end:{line:4,column:40}}}):r)+'</span>\r\n        <div class="mesage-content">\r\n            <div class="message-text">'+i(typeof(r=null!=(r=t.message||(null!=a?a.message:a))?r:l)===c?r.call(o,{name:"message",hash:{},data:s,loc:{start:{line:6,column:38},end:{line:6,column:49}}}):r)+'</div>\r\n            <div class="message-time">'+i(typeof(r=null!=(r=t.currentDate||(null!=a?a.currentDate:a))?r:l)===c?r.call(o,{name:"currentDate",hash:{},data:s,loc:{start:{line:7,column:38},end:{line:7,column:53}}}):r)+"</div>\r\n        </div>\r\n    </div>\r\n</li>"},useData:!0})},L1EO:function(e,a,t){},QfWi:function(e,a,t){"use strict";t.r(a);t("L1EO"),t("ZXyM"),t("D/wG"),t("e+qc");var n,s,r,o=t("6yvc"),l=t.n(o),c={load:function(e){try{var a=localStorage.getItem(e);return null===a?void 0:JSON.parse(a)}catch(e){console.error("Get state error: ",e)}},save:function(e,a){try{var t=JSON.stringify(a);localStorage.setItem(e,t)}catch(e){console.error("Set state error: ",e)}}},i={massege:document.querySelector("#chat"),form:document.querySelector("#inputForm"),asyncMap:document.querySelector('[data-name="async"]'),file:document.querySelector("#file"),userNameForm:document.querySelector("#userNameForm"),chatSection:document.querySelector(".chatSection"),registrationSection:document.querySelector(".registration"),changeDataButton:document.querySelector("#changeData"),avatarImg:document.querySelector("#avatarImg")},m="",u={};function d(e){return String(e).padStart(2,"0")}navigator.geolocation.getCurrentPosition((function(e){u.lat=e.coords.latitude,u.lng=e.coords.longitude})),i.asyncMap.src="https://maps.googleapis.com/maps/api/js?key=AIzaSyB7Zkwv8ZHein66BAALTpWsJAQorKjiTlw",i.asyncMap.type="text/javascript",i.asyncMap.onload=function(){s=new google.maps.Map(document.getElementById("map"),{zoom:10,center:u})};var g=new WebSocket("wss://venify.herokuapp.com/chat");g.onmessage=function(e){var a,t=e.data,n=d((a=new Date).getHours())+":"+d(a.getMinutes())+":"+d(a.getSeconds()),o=JSON.parse(t),c=o.cords,u=o.message,g=o.name,v=o.image;r=g===m?"myUser":"anotherUser";var p=l()({message:u,name:g,image:v,currentDate:n,className:r});i.massege.insertAdjacentHTML("beforeend",p);new google.maps.Marker({position:c,map:s})},i.file.addEventListener("change",(function(e){var a=e.target.files[0],t=new FileReader;t.readAsDataURL(a),t.addEventListener("load",(function(e){n=e.target.result,avatarImg.src=n}))}));i.userNameForm.addEventListener("submit",(function(e){var a;e.preventDefault(),""===e.target.elements.userName.value?alert("Введите имя"):(a=e.target.elements.userName.value,m=a,void 0===n&&(n="https://image.flaticon.com/icons/png/512/18/18436.png"),function(){localStorage.removeItem("local");var e={name:m,image:n};c.save("local",e)}(),i.chatSection.classList.add("visible"),i.registrationSection.classList.add("invisible"))})),i.changeDataButton.addEventListener("click",(function(e){e.preventDefault(),i.registrationSection.classList.toggle("invisible"),i.chatSection.classList.toggle("visible")})),i.form.addEventListener("submit",(function(e){var a;e.preventDefault(),a=e.target.elements.inputField.value,g.send(JSON.stringify({cords:u,message:a,name:m,image:n})),e.target.elements.inputField.value=""})),window.addEventListener("DOMContentLoaded",(function(e){var a=c.load("local"),t=a.name,s=a.image;void 0!==t&&(e.target.body.children.registration.children.userNameForm.elements.userName.value=t),void 0!==s&&(avatarImg.src=s,n=s)}))}},[["QfWi",1,2]]]);
//# sourceMappingURL=main.c99ea7c71ec30ef9a925.js.map