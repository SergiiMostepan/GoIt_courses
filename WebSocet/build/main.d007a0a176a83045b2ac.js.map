{"version":3,"sources":["webpack:///./js-components/app.js"],"names":["window","URL","webkitURL","myFile","map","refs","massege","document","querySelector","form","asyncMap","file","userNameForm","chatSection","registrationSection","changeDataButton","avatarImg","userName","uluru","pad","value","String","padStart","navigator","geolocation","getCurrentPosition","position","lat","coords","latitude","lng","longitude","src","type","onload","google","maps","Map","getElementById","zoom","center","ws","WebSocket","onmessage","date","data","currentDate","Date","getHours","getMinutes","getSeconds","JSON","parse","cords","message","name","image","newMessage","createElement","textContent","appendChild","element","classList","add","createImage","Marker","addEventListener","e","target","files","FR","FileReader","readAsDataURL","result","inputName","preventDefault","elements","toggle","inputField","send","stringify"],"mappings":"mNAAAA,OAAOC,IAAMD,OAAOC,KAAOD,OAAOE,UAClC,IAaIC,EACAC,EAdEC,EAAO,CACXC,QAASC,SAASC,cAAc,SAChCC,KAAMF,SAASC,cAAc,cAC7BE,SAAUH,SAASC,cAAc,uBACjCG,KAAMJ,SAASC,cAAc,SAC7BI,aAAcL,SAASC,cAAc,iBACrCK,YAAaN,SAASC,cAAc,gBACpCM,oBAAqBP,SAASC,cAAc,iBAC5CO,iBAAkBR,SAASC,cAAc,eACzCQ,UAAWT,SAASC,cAAc,eAGhCS,EAAW,GAGXC,EAAQ,GA8BZ,SAASC,EAAIC,GACX,OAAOC,OAAOD,GAAOE,SAAS,EAAG,KA5BnCC,UAAUC,YAAYC,oBAAmB,SAAAC,GACvCR,EAAMS,IAAMD,EAASE,OAAOC,SAC5BX,EAAMY,IAAMJ,EAASE,OAAOG,aAK5B1B,EAAKK,SAASsB,IACZ,sFACF3B,EAAKK,SAASuB,KAAO,kBACrB5B,EAAKK,SAASwB,OAAS,WACrB9B,EAAM,IAAI+B,OAAOC,KAAKC,IAAI9B,SAAS+B,eAAe,OAAQ,CACxDC,KAAM,GACNC,OAAQtB,KAmBd,IAAIuB,EAAK,IAAIC,UAAU,mCAGvBD,EAAGE,UAAY,YAAc,IAfvBC,EAeYC,EAAW,EAAXA,KACZC,EAfI3B,GADJyB,EAAO,IAAIG,MACEC,YAGjB,IAFQ7B,EAAIyB,EAAKK,cAEjB,IADQ9B,EAAIyB,EAAKM,cAYU,EAEaC,KAAKC,MAAMP,GAA3CQ,EAFmB,EAEnBA,MAAOC,EAFY,EAEZA,QAASC,EAFG,EAEHA,KAAMC,EAFH,EAEGA,MACxBC,EAAalD,SAASmD,cAAc,MAC1CD,EAAWE,YAAcb,EAAc,OAASS,EAAO,KAAOD,EAC9DjD,EAAKC,QAAQsD,YAAYH,GAS3B,SAAqBzB,EAAK6B,GACxB,IAAML,EAAQjD,SAASmD,cAAc,OACrCF,EAAMM,UAAUC,IAAI,OACpBP,EAAMxB,IAAMA,EACZ6B,EAAQD,YAAYJ,GAZpBQ,CAAYR,EAAOnD,EAAKC,SACT,IAAI6B,OAAOC,KAAK6B,OAAO,CACpCvC,SAAU2B,EACVjD,IAAKA,KAYTC,EAAKM,KAAKuD,iBAAiB,UAAU,SAAAC,GACnC,IAAMxD,EAAOwD,EAAEC,OAAOC,MAAM,GACtBC,EAAK,IAAIC,WACfD,EAAGE,cAAc7D,GACjB2D,EAAGJ,iBAAiB,QAAQ,SAASC,GACnChE,EAASgE,EAAEC,OAAOK,OAClBzD,UAAUgB,IAAM7B,QAgCpBE,EAAKO,aAAasD,iBAAiB,UAAU,SAAAC,GAd7C,IAAiBO,EAefP,EAAEQ,iBAfaD,EAgBPP,EAAEC,OAAOQ,SAAS3D,SAASG,MAdnCH,EAAWyD,EAeXP,EAAEC,OAAOQ,SAAS3D,SAASG,MAAQ,GAZnCf,EAAKQ,YAAYiD,UAAUC,IAAI,WAC/B1D,EAAKS,oBAAoBgD,UAAUC,IAAI,gBAezC1D,EAAKU,iBAAiBmD,iBAAiB,SAAS,SAAAC,GAC9CA,EAAEQ,iBAZFtE,EAAKS,oBAAoBgD,UAAUe,OAAO,aAC1CxE,EAAKQ,YAAYiD,UAAUe,OAAO,cAepCxE,EAAKI,KAAKyD,iBAAiB,UAAU,SAAAC,GAtCpB,IAAAb,EAuCfa,EAAEQ,iBAvCarB,EAwCNa,EAAEC,OAAOQ,SAASE,WAAW1D,MAvCtCqB,EAAGsC,KACD5B,KAAK6B,UAAU,CACb3B,MAAOnC,EACPoC,QAASA,EACTC,KAAMtC,EACNuC,MAAOrD,KAmCXgE,EAAEC,OAAOQ,SAASE,WAAW1D,MAAQ,Q","file":"main.d007a0a176a83045b2ac.js","sourcesContent":["window.URL = window.URL || window.webkitURL;\r\nconst refs = {\r\n  massege: document.querySelector('#chat'),\r\n  form: document.querySelector('#inputForm'),\r\n  asyncMap: document.querySelector('[data-name=\"async\"]'),\r\n  file: document.querySelector('#file'),\r\n  userNameForm: document.querySelector('#userNameForm'),\r\n  chatSection: document.querySelector('.chatSection'),\r\n  registrationSection: document.querySelector('.registration'),\r\n  changeDataButton: document.querySelector('#changeData'),\r\n  avatarImg: document.querySelector('#avatarImg'),\r\n};\r\n\r\nlet userName = '';\r\nlet myFile;\r\nlet map;\r\nlet uluru = {};\r\n\r\n// получаем текущую геолокацию\r\nnavigator.geolocation.getCurrentPosition(position => {\r\n  uluru.lat = position.coords.latitude;\r\n  uluru.lng = position.coords.longitude;\r\n});\r\n\r\n// создаем карту\r\n(function googleMap() {\r\n  refs.asyncMap.src =\r\n    'https://maps.googleapis.com/maps/api/js?key=AIzaSyB7Zkwv8ZHein66BAALTpWsJAQorKjiTlw';\r\n  refs.asyncMap.type = 'text/javascript';\r\n  refs.asyncMap.onload = () => {\r\n    map = new google.maps.Map(document.getElementById('map'), {\r\n      zoom: 10,\r\n      center: uluru,\r\n    });\r\n  };\r\n})();\r\n\r\n// берем текущее время\r\nfunction getDate() {\r\n  let date = new Date();\r\n  let h = pad(date.getHours());\r\n  let m = pad(date.getMinutes());\r\n  let s = pad(date.getSeconds());\r\n  return `${h}:${m}:${s}`;\r\n}\r\n\r\nfunction pad(value) {\r\n  return String(value).padStart(2, '0');\r\n}\r\n\r\n// создаем соединение\r\nlet ws = new WebSocket('wss://venify.herokuapp.com/chat');\r\n\r\n// выводим инфу с сервака\r\nws.onmessage = ({ data }) => {\r\n  let currentDate = getDate();\r\n  const { cords, message, name, image } = JSON.parse(data);\r\n  const newMessage = document.createElement('li');\r\n  newMessage.textContent = currentDate + ':   ' + name + ': ' + message;\r\n  refs.massege.appendChild(newMessage);\r\n  createImage(image, refs.massege);\r\n  const marker = new google.maps.Marker({\r\n    position: cords,\r\n    map: map,\r\n  });\r\n};\r\n\r\n// создаем елемент фото\r\nfunction createImage(src, element) {\r\n  const image = document.createElement('img');\r\n  image.classList.add('img');\r\n  image.src = src;\r\n  element.appendChild(image);\r\n}\r\n\r\nrefs.file.addEventListener('change', e => {\r\n  const file = e.target.files[0];\r\n  const FR = new FileReader();\r\n  FR.readAsDataURL(file);\r\n  FR.addEventListener('load', function(e) {\r\n    myFile = e.target.result;\r\n    avatarImg.src = myFile;\r\n    // createImage(myFile, refs.registrationSection);\r\n  });\r\n});\r\n\r\n// отправляем данные на сервер\r\nconst sendData = message => {\r\n  ws.send(\r\n    JSON.stringify({\r\n      cords: uluru,\r\n      message: message,\r\n      name: userName,\r\n      image: myFile,\r\n    }),\r\n  );\r\n};\r\n\r\n// вводим имя\r\nfunction newName(inputName) {\r\n  // if (userName === '')\r\n  userName = inputName;\r\n}\r\nfunction visibleChat() {\r\n  refs.chatSection.classList.add('visible');\r\n  refs.registrationSection.classList.add('invisible');\r\n}\r\n\r\nfunction changeData() {\r\n  refs.registrationSection.classList.toggle('invisible');\r\n  refs.chatSection.classList.toggle('visible');\r\n}\r\n\r\nrefs.userNameForm.addEventListener('submit', e => {\r\n  e.preventDefault();\r\n  newName(e.target.elements.userName.value);\r\n  e.target.elements.userName.value = '';\r\n  visibleChat();\r\n});\r\n\r\nrefs.changeDataButton.addEventListener('click', e => {\r\n  e.preventDefault();\r\n  changeData();\r\n});\r\n\r\nrefs.form.addEventListener('submit', e => {\r\n  e.preventDefault();\r\n  sendData(e.target.elements.inputField.value);\r\n  e.target.elements.inputField.value = '';\r\n});\r\n"],"sourceRoot":""}