{"version":3,"sources":["webpack:///./templates/message.hbs","webpack:///./js-components/app.js"],"names":["Handlebars","module","exports","template","container","depth0","helpers","partials","data","helper","alias1","nullContext","alias2","hooks","helperMissing","alias3","alias4","escapeExpression","className","call","image","name","message","currentDate","myFile","map","refs","massege","document","querySelector","form","asyncMap","file","userNameForm","chatSection","registrationSection","changeDataButton","avatarImg","userName","uluru","pad","value","String","padStart","navigator","geolocation","getCurrentPosition","position","lat","coords","latitude","lng","longitude","src","type","onload","google","maps","Map","getElementById","zoom","center","ws","WebSocket","onmessage","date","Date","getHours","getMinutes","getSeconds","JSON","parse","cords","markup","messageTemplate","insertAdjacentHTML","Marker","addEventListener","e","target","files","FR","FileReader","readAsDataURL","result","inputName","preventDefault","elements","classList","add","toggle","inputField","send","stringify"],"mappings":"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","file":"main.d6a162baf67bc1ebef0d.js","sourcesContent":["var Handlebars = require(\"../../node_modules/handlebars/runtime.js\");\nfunction __default(obj) { return obj && (obj.__esModule ? obj[\"default\"] : obj); }\nmodule.exports = (Handlebars[\"default\"] || Handlebars).template({\"compiler\":[8,\">= 4.3.0\"],\"main\":function(container,depth0,helpers,partials,data) {\n    var helper, alias1=depth0 != null ? depth0 : (container.nullContext || {}), alias2=container.hooks.helperMissing, alias3=\"function\", alias4=container.escapeExpression;\n\n  return \"<li class=\\\"message \"\n    + alias4(((helper = (helper = helpers.className || (depth0 != null ? depth0.className : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{\"name\":\"className\",\"hash\":{},\"data\":data,\"loc\":{\"start\":{\"line\":1,\"column\":19},\"end\":{\"line\":1,\"column\":32}}}) : helper)))\n    + \"\\\">\\r\\n    <img class=\\\"image\\\" src=\\\"\"\n    + alias4(((helper = (helper = helpers.image || (depth0 != null ? depth0.image : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{\"name\":\"image\",\"hash\":{},\"data\":data,\"loc\":{\"start\":{\"line\":2,\"column\":28},\"end\":{\"line\":2,\"column\":37}}}) : helper)))\n    + \"\\\">\\r\\n    <div class=\\\"message-body\\\">\\r\\n        <span class=\\\"user-name\\\">\"\n    + alias4(((helper = (helper = helpers.name || (depth0 != null ? depth0.name : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{\"name\":\"name\",\"hash\":{},\"data\":data,\"loc\":{\"start\":{\"line\":4,\"column\":32},\"end\":{\"line\":4,\"column\":40}}}) : helper)))\n    + \"</span>\\r\\n        <div class=\\\"mesage-content\\\">\\r\\n            <div class=\\\"message-text\\\">\"\n    + alias4(((helper = (helper = helpers.message || (depth0 != null ? depth0.message : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{\"name\":\"message\",\"hash\":{},\"data\":data,\"loc\":{\"start\":{\"line\":6,\"column\":38},\"end\":{\"line\":6,\"column\":49}}}) : helper)))\n    + \"</div>\\r\\n            <div class=\\\"message-time\\\">\"\n    + alias4(((helper = (helper = helpers.currentDate || (depth0 != null ? depth0.currentDate : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{\"name\":\"currentDate\",\"hash\":{},\"data\":data,\"loc\":{\"start\":{\"line\":7,\"column\":38},\"end\":{\"line\":7,\"column\":53}}}) : helper)))\n    + \"</div>\\r\\n        </div>\\r\\n    </div>\\r\\n</li>\";\n},\"useData\":true});","import messageTemplate from '../templates/message.hbs';\r\n\r\nconst refs = {\r\n  massege: document.querySelector('#chat'),\r\n  form: document.querySelector('#inputForm'),\r\n  asyncMap: document.querySelector('[data-name=\"async\"]'),\r\n  file: document.querySelector('#file'),\r\n  userNameForm: document.querySelector('#userNameForm'),\r\n  chatSection: document.querySelector('.chatSection'),\r\n  registrationSection: document.querySelector('.registration'),\r\n  changeDataButton: document.querySelector('#changeData'),\r\n  avatarImg: document.querySelector('#avatarImg'),\r\n};\r\n\r\nlet userName = '';\r\nlet myFile;\r\nlet map;\r\nlet uluru = {};\r\nlet className;\r\n\r\n// получаем текущую геолокацию\r\nnavigator.geolocation.getCurrentPosition(position => {\r\n  uluru.lat = position.coords.latitude;\r\n  uluru.lng = position.coords.longitude;\r\n});\r\n\r\n// создаем карту\r\n(function googleMap() {\r\n  refs.asyncMap.src =\r\n    'https://maps.googleapis.com/maps/api/js?key=AIzaSyB7Zkwv8ZHein66BAALTpWsJAQorKjiTlw';\r\n  refs.asyncMap.type = 'text/javascript';\r\n  refs.asyncMap.onload = () => {\r\n    map = new google.maps.Map(document.getElementById('map'), {\r\n      zoom: 10,\r\n      center: uluru,\r\n    });\r\n  };\r\n})();\r\n\r\n// берем текущее время\r\nfunction getDate() {\r\n  let date = new Date();\r\n  let h = pad(date.getHours());\r\n  let m = pad(date.getMinutes());\r\n  let s = pad(date.getSeconds());\r\n  return `${h}:${m}:${s}`;\r\n}\r\n\r\nfunction pad(value) {\r\n  return String(value).padStart(2, '0');\r\n}\r\n\r\n// создаем соединение\r\nlet ws = new WebSocket('wss://venify.herokuapp.com/chat');\r\n\r\n// выводим инфу с сервака\r\nws.onmessage = ({\r\n  data\r\n}) => {\r\n  let currentDate = getDate();\r\n  const {\r\n    cords,\r\n    message,\r\n    name,\r\n    image\r\n  } = JSON.parse(data);\r\n  if (name === userName) {\r\n    className = 'myUser'\r\n  } else {\r\n    className = 'anotherUser'\r\n  }\r\n  let markup = messageTemplate({\r\n    message,\r\n    name,\r\n    image,\r\n    currentDate,\r\n    className\r\n  });\r\n  refs.massege.insertAdjacentHTML('beforeend', markup)\r\n  const marker = new google.maps.Marker({\r\n    position: cords,\r\n    map: map,\r\n  });\r\n};\r\n\r\n// function createMessage(currentDate, name, message) {\r\n//   const newMessage = document.createElement('li');\r\n//   newMessage.textContent = currentDate + ':   ' + name + ': ' + message;\r\n//   refs.massege.appendChild(newMessage);\r\n// }\r\n\r\nrefs.file.addEventListener('change', e => {\r\n  const file = e.target.files[0];\r\n  const FR = new FileReader();\r\n  FR.readAsDataURL(file);\r\n  FR.addEventListener('load', function (e) {\r\n    myFile = e.target.result;\r\n    avatarImg.src = myFile;\r\n  });\r\n});\r\n\r\n// отправляем данные на сервер\r\nconst sendData = message => {\r\n  ws.send(\r\n    JSON.stringify({\r\n      cords: uluru,\r\n      message: message,\r\n      name: userName,\r\n      image: myFile,\r\n    }),\r\n  );\r\n};\r\n\r\n// вводим имя\r\nfunction newName(inputName) {\r\n  // if (userName === '')\r\n  userName = inputName;\r\n}\r\n\r\nfunction visibleChat() {\r\n  refs.chatSection.classList.add('visible');\r\n  refs.registrationSection.classList.add('invisible');\r\n}\r\n\r\nfunction changeData() {\r\n  refs.registrationSection.classList.toggle('invisible');\r\n  refs.chatSection.classList.toggle('visible');\r\n}\r\n\r\nrefs.userNameForm.addEventListener('submit', e => {\r\n  e.preventDefault();\r\n  newName(e.target.elements.userName.value);\r\n  e.target.elements.userName.value = '';\r\n  visibleChat();\r\n});\r\n\r\nrefs.changeDataButton.addEventListener('click', e => {\r\n  e.preventDefault();\r\n  changeData();\r\n});\r\n\r\nrefs.form.addEventListener('submit', e => {\r\n  e.preventDefault();\r\n  sendData(e.target.elements.inputField.value);\r\n  e.target.elements.inputField.value = '';\r\n});\r\n"],"sourceRoot":""}